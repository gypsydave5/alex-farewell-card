<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <link type="text/css" rel="stylesheet" href="public/css/html5-doctor-reset-stylesheet.min.css">
  <link type="text/css" rel="stylesheet" href="public/css/styles.css">
  <title>test page</title>
</head>

<body>
  <header>
    <img id="photo" src="public/img/alex.png">
    <div id="about">Some text.</div>

    <form method="POST" id="test-post">
      <input id="name" placeholder="name">
      <select id="cohort">
          <option value="" default selected>Cohort</option>
          <option value="sep14">September '14</option>
          <option value="aug14">August '14</option>
          <option value="jun14">June '14</option>
          <option value="may14">May '14</option>
          <option value="mar14">March '14</option>
          <option value="feb14">February '14</option>
          <option value="jan14">January '14</option>
          <option value="nov13">November '13</option>
          <option value="oct13">October '13</option>
          <option value="sep13">September '13</option>
          <option value="jul13">July '13</option>
          <option value="jun13">June '13</option>
      </select>
      <input id="message" placeholder="message">
      <button type="submit">Submit message</button>
    </form>
  </header>
  <br clear="all">
  <section class="message-container">
  </section>

  <script src="script/jquery-2.1.1.min.js"></script>
  <script src="script/jquery.modal.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="https://cdn.firebase.com/js/client/1.0.21/firebase.js"></script>
  <script src="script/firebase-post.js"></script>
  <script src="script/interface.js"></script>
  <script>
  var test = new Firebase('https://noxtest.firebaseio.com/test'); //sets which Firebase branch to post to
var inline_template = $('#message-template').html();

  var usersRef = test.child("users"); //sets the child branch it will be posting to, so test/users in this case

  var getUsers = function(){
    $('.message-container').empty()
    usersRef.on('value', function(user){
      var users = user.val();
      for(name in users){
        $( "<article class='tile'><a id='#" + name + "' rel='modal:open'>" + users[name].name + "</a></article><article class='modal' style='display:none;' id='" + name + "'>" +'<h1>'+users[name].name + '</h1>' + '<h2>' + users[name].cohort + '</h2>' + '<p>' + users[name].message + '</p></article>').prependTo('.message-container')
      }
    })
  }

  $(document).ready( function() {
    getUsers();
   $('#post').on('submit', function(e) {
    e.preventDefault();
    var postName = $('#name').val();
      usersRef.push({
          name: $('#name').val(),
          cohort: $("#cohort").val(),
          message: $("#message").val()
      })
    getUsers();
    });
  })
  </script>
</body>
</html>
